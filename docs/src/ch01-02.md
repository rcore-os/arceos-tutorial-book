## RUST å¼€å‘ç¯å¢ƒé…ç½®

é¦–å…ˆå®‰è£… Rust ç‰ˆæœ¬ç®¡ç†å™¨ rustup å’Œ Rust åŒ…ç®¡ç†å™¨ cargoï¼Œè¿™é‡Œæˆ‘ä»¬ç”¨å®˜æ–¹çš„å®‰è£…è„šæœ¬æ¥å®‰è£…ï¼š

`curl https://sh.rustup.rs -sSf | sh`

å¦‚æœé€šè¿‡å®˜æ–¹çš„è„šæœ¬ä¸‹è½½å¤±è´¥äº†ï¼Œå¯ä»¥åœ¨æµè§ˆå™¨çš„åœ°å€æ ä¸­è¾“å…¥ [https://sh.rustup.rs](https://sh.rustup.rs/) æ¥ä¸‹è½½è„šæœ¬ï¼Œåœ¨æœ¬åœ°è¿è¡Œå³å¯ã€‚

å¦‚æœå®˜æ–¹çš„è„šæœ¬åœ¨è¿è¡Œæ—¶å‡ºç°äº†ç½‘ç»œé€Ÿåº¦è¾ƒæ…¢çš„é—®é¢˜ï¼Œå¯é€‰åœ°å¯ä»¥é€šè¿‡ä¿®æ”¹ rustup çš„é•œåƒåœ°å€ï¼ˆä¿®æ”¹ä¸ºä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦çš„é•œåƒæœåŠ¡å™¨ï¼‰æ¥åŠ é€Ÿï¼š

```
export RUSTUP_DIST_SERVER=https://mirrors.ustc.edu.cn/rust-static
export RUSTUP_UPDATE_ROOT=https://mirrors.ustc.edu.cn/rust-static/rustup
curl https://sh.rustup.rs -sSf | sh
```

æˆ–è€…ä½¿ç”¨ tuna æºæ¥åŠ é€Ÿ [å‚è§ rustup å¸®åŠ©](https://mirrors.tuna.tsinghua.edu.cn/help/rustup/)ï¼š

```
export RUSTUP_DIST_SERVER=https://mirrors.tuna.edu.cn/rustup
export RUSTUP_UPDATE_ROOT=https://mirrors.tuna.edu.cn/rustup/rustup
curl https://sh.rustup.rs -sSf | sh
```

æˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡åœ¨è¿è¡Œå‰è®¾ç½®å‘½ä»¤è¡Œä¸­çš„ç§‘å­¦ä¸Šç½‘ä»£ç†æ¥å®ç°ï¼š

```
# e.g. Shadowsocks ä»£ç†ï¼Œè¯·æ ¹æ®è‡ªèº«é…ç½®çµæ´»è°ƒæ•´ä¸‹é¢çš„é“¾æ¥
export https_proxy=http://127.0.0.1:1080
export http_proxy=http://127.0.0.1:1080
export ftp_proxy=http://127.0.0.1:1080
```

å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°æ‰“å¼€ä¸€ä¸ªç»ˆç«¯æ¥è®©ä¹‹å‰è®¾ç½®çš„ç¯å¢ƒå˜é‡ç”Ÿæ•ˆã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨å°†ç¯å¢ƒå˜é‡è®¾ç½®åº”ç”¨åˆ°å½“å‰ç»ˆç«¯ï¼Œåªéœ€è¦è¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼š

`source $HOME/.cargo/env`

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç¡®è®¤ä¸€ä¸‹æˆ‘ä»¬æ­£ç¡®å®‰è£…äº† Rust å·¥å…·é“¾ï¼š

`rustc --version`

å¯ä»¥çœ‹åˆ°å½“å‰å®‰è£…çš„å·¥å…·é“¾çš„ç‰ˆæœ¬ã€‚

`rustc 1.73.0-nightly (993deaa0b 2023-07-11)`

<font color=red>**è­¦å‘Šï¼**</font>

ç›®å‰ç”¨äºæ“ä½œç³»ç»Ÿå®éªŒå¼€å‘çš„ rustc ç¼–è¯‘å™¨çš„ç‰ˆæœ¬ä¸å±€é™åœ¨ 1.73.0 è¿™æ ·çš„æ•°å­—ä¸Šï¼Œä½ å¯ä»¥é€‰æ‹©æ›´æ–°ç‰ˆæœ¬çš„ rustc ç¼–è¯‘å™¨ã€‚ä½†æ³¨æ„**åªèƒ½ç”¨ rustc çš„ nightly ç±»å‹çš„ç‰ˆæœ¬**ã€‚

---

å¯é€šè¿‡å¦‚ä¸‹å‘½ä»¤å®‰è£… rustc çš„ nightly ç‰ˆæœ¬ï¼Œå¹¶æŠŠè¯¥ç‰ˆæœ¬è®¾ç½®ä¸º rustc çš„ç¼ºçœç‰ˆæœ¬ã€‚

```
rustup install nightly
rustup default nightly
```

æˆ‘ä»¬æœ€å¥½æŠŠè½¯ä»¶åŒ…ç®¡ç†å™¨ cargo æ‰€ç”¨çš„è½¯ä»¶åŒ…é•œåƒåœ°å€ crates.io ä¹Ÿæ¢æˆä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦çš„é•œåƒæœåŠ¡å™¨æ¥åŠ é€Ÿä¸‰æ–¹åº“çš„ä¸‹è½½ã€‚æˆ‘ä»¬æ‰“å¼€ï¼ˆå¦‚æœæ²¡æœ‰å°±æ–°å»ºï¼‰ `~/.cargo/config` æ–‡ä»¶ï¼Œå¹¶æŠŠå†…å®¹ä¿®æ”¹ä¸ºï¼š

```
[source.crates-io]
registry = "https://github.com/rust-lang/crates.io-index"
replace-with = 'ustc'
[source.ustc]
registry = "git://mirrors.ustc.edu.cn/crates.io-index"
```

åŒæ ·ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ tuna æº [å‚è§ crates.io å¸®åŠ©](https://mirrors.tuna.tsinghua.edu.cn/help/crates.io-index.git/)ï¼š

```
[source.crates-io]
replace-with = 'tuna'

[source.tuna]
registry = "https://mirrors.tuna.tsinghua.edu.cn/git/crates.io-index.git"
```

æ¥ä¸‹æ¥å®‰è£…ä¸€äº›Rustç›¸å…³çš„è½¯ä»¶åŒ…

```
rustup target add riscv64gc-unknown-none-elf
rustup component add llvm-tools-preview
rustup component add rust-src
```

<font color=red>**è­¦å‘Šï¼**</font>

å¦‚æœä½ æ¢äº†å¦å¤–ä¸€ä¸ª rustc ç¼–è¯‘å™¨ï¼ˆå¿…é¡»æ˜¯ nightly ç‰ˆçš„ï¼‰ï¼Œ**éœ€è¦é‡æ–°å®‰è£…ä¸Šè¿° rustc æ‰€éœ€è½¯ä»¶åŒ…**ã€‚ArceOS ä»“åº“ä¸­çš„ `Makefile` åŒ…å«äº†è¿™äº›å·¥å…·çš„å®‰è£…ï¼Œå¦‚æœä½ ä½¿ç”¨ `make run` ä¹Ÿå¯ä»¥ä¸æ‰‹åŠ¨å®‰è£…ã€‚

---

è‡³äº Rust å¼€å‘ç¯å¢ƒï¼Œæ¨è JetBrains Clion + Rustæ’ä»¶ æˆ–è€… Visual Studio Code æ­é… rust-analyzer å’Œ RISC-V Support æ’ä»¶ã€‚

<font color=blue>**æ³¨è§£ğŸ‘‰**</font>

- JetBrains Clion ä»˜è´¹å•†ä¸šè½¯ä»¶ï¼Œä½†å¯¹äºå­¦ç”Ÿå’Œæ•™å¸ˆï¼Œåªè¦åœ¨ JetBrains ç½‘ç«™æ³¨å†Œè´¦å·ï¼Œå¯ä»¥äº«å—ä¸€å®šæœŸé™ï¼ˆåŠå¹´å·¦å³ï¼‰çš„å…è´¹ä½¿ç”¨çš„ç¦åˆ©ã€‚
- Visual Studio Code æ˜¯å¼€æºè½¯ä»¶ï¼Œä¸ç”¨ä»˜è´¹å°±å¯ä½¿ç”¨ã€‚
- å½“ç„¶ï¼Œé‡‡ç”¨ VIMï¼ŒEmacs ç­‰ä¼ ç»Ÿçš„ç¼–è¾‘å™¨ä¹Ÿæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚

---
